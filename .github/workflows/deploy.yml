name: Deploy to GitHub Pages

on:
  # Ð—Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ Ð¿Ñ€Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð¼ Ð¿ÑƒÑˆÐµ Ð² Ð²ÐµÑ‚ÐºÑƒ main
  push:
    branches: [ "main" ]
  # Ð˜Ð»Ð¸ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ð¸Ð· Ð²ÐºÐ»Ð°Ð´ÐºÐ¸ Actions
  workflow_dispatch:

# Ð Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð´ÐµÐ¿Ð»Ð¾Ñ
permissions:
  contents: read
  pages: write
  id-token: write

# Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´ÐµÐ¿Ð»Ð¾Ñ
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout ÐºÐ¾Ð´
        uses: actions/checkout@v4
        
      - name: Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹
        run: |
          echo "ðŸ“ Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ:"
          ls -la
          echo ""
          echo "ðŸ“„ ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° index.html:"
          if [ -f "index.html" ]; then
            echo "âœ… index.html Ð½Ð°Ð¹Ð´ÐµÐ½"
          else
            echo "âŒ index.html Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!"
            exit 1
          fi
          
      - name: Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ package.json
        run: |
          cat > package.json << EOF
          {
            "name": "mapattack",
            "version": "1.0.0",
            "description": "Military Map Attack Game",
            "main": "index.html",
            "scripts": {
              "start": "echo 'Open index.html in browser'"
            },
            "keywords": ["game", "military", "map"],
            "author": "Trashdono1",
            "license": "MIT"
          }
          EOF
          
      - name: Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ñ‹
        uses: actions/upload-pages-artifact@v3
        with:
          path: .

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
      
    runs-on: ubuntu-latest
    needs: build
    
    steps:
      - name: Ð”ÐµÐ¿Ð»Ð¾Ð¹ Ð½Ð° GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
